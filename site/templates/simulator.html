<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur CO‚ÇÇ - Morpheus</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        * {
            box-sizing: border-box;
        }

        /* Dark mode background already set in body by style.css */
        
        /* Light mode support - using CSS variables */
        :root[style*="--bg: #f8f9fa"],
        html[style*="--bg: #f8f9fa"] {
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #1a1f36;
            --muted: #6c757d;
            --accent: #0066cc;
        }
        
        :root[style*="--bg: #f8f9fa"] body,
        html[style*="--bg: #f8f9fa"] body {
            background: var(--bg);
        }
        
        /* Light mode: Simulator container */
        :root[style*="--bg: #f8f9fa"] .simulator-container,
        html[style*="--bg: #f8f9fa"] .simulator-container {
            background: var(--bg);
            color: var(--text);
        }
        
        /* Light mode: Simulator header - Material Design */
        :root[style*="--bg: #f8f9fa"] .simulator-header,
        html[style*="--bg: #f8f9fa"] .simulator-header {
            background: linear-gradient(135deg, #0066cc 0%, #0052a3 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(0, 102, 204, 0.15);
        }
        
        /* Light mode: Section titles */
        :root[style*="--bg: #f8f9fa"] .section-title h2,
        html[style*="--bg: #f8f9fa"] .section-title h2 {
            color: var(--text);
        }
        
        /* Light mode: Status cards - Material Design */
        :root[style*="--bg: #f8f9fa"] .status-card,
        html[style*="--bg: #f8f9fa"] .status-card {
            background: var(--card);
            border-color: rgba(0, 102, 204, 0.15);
            color: var(--text);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .status-card:hover,
        html[style*="--bg: #f8f9fa"] .status-card:hover {
            border-color: rgba(0, 102, 204, 0.3);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.12);
            transform: translateY(-2px);
        }
        
        :root[style*="--bg: #f8f9fa"] .status-label,
        html[style*="--bg: #f8f9fa"] .status-label {
            color: var(--muted);
        }
        
        :root[style*="--bg: #f8f9fa"] .status-value,
        html[style*="--bg: #f8f9fa"] .status-value {
            color: #0066cc;
        }
        
        /* Light mode: Scenario cards - Material Design */
        :root[style*="--bg: #f8f9fa"] .scenario-card,
        html[style*="--bg: #f8f9fa"] .scenario-card {
            background: var(--card);
            border-color: rgba(0, 102, 204, 0.15);
            color: var(--text);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-card:hover,
        html[style*="--bg: #f8f9fa"] .scenario-card:hover {
            border-color: rgba(0, 102, 204, 0.3);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.12);
            transform: translateY(-3px);
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-card h4,
        html[style*="--bg: #f8f9fa"] .scenario-card h4 {
            color: var(--text);
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-card p,
        html[style*="--bg: #f8f9fa"] .scenario-card p {
            color: var(--muted);
        }
        
        /* Light mode: Scenario buttons */
        :root[style*="--bg: #f8f9fa"] .scenario-btn,
        html[style*="--bg: #f8f9fa"] .scenario-btn {
            background: #0066cc;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.2);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-btn:hover,
        html[style*="--bg: #f8f9fa"] .scenario-btn:hover {
            background: #0052a3;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
            transform: translateY(-2px);
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-btn.danger,
        html[style*="--bg: #f8f9fa"] .scenario-btn.danger {
            background: #dc3545;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-btn.danger:hover,
        html[style*="--bg: #f8f9fa"] .scenario-btn.danger:hover {
            background: #c82333;
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        /* Light mode: Form inputs */
        :root[style*="--bg: #f8f9fa"] .scenario-input,
        html[style*="--bg: #f8f9fa"] .scenario-input {
            background: rgba(0, 102, 204, 0.05);
            border-color: rgba(0, 102, 204, 0.25);
            color: var(--text);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-input:focus,
        html[style*="--bg: #f8f9fa"] .scenario-input:focus {
            background: rgba(0, 102, 204, 0.02);
            border-color: #0066cc;
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        :root[style*="--bg: #f8f9fa"] .scenario-input::placeholder,
        html[style*="--bg: #f8f9fa"] .scenario-input::placeholder {
            color: #9ca3af;
        }
        
        /* Light mode: Status messages */
        :root[style*="--bg: #f8f9fa"] .status-message,
        html[style*="--bg: #f8f9fa"] .status-message {
            background: rgba(0, 102, 204, 0.08);
            border-color: rgba(0, 102, 204, 0.25);
            color: #0066cc;
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .status-message.success,
        html[style*="--bg: #f8f9fa"] .status-message.success {
            background: rgba(40, 167, 69, 0.1);
            border-color: rgba(40, 167, 69, 0.25);
            color: #28a745;
        }
        
        :root[style*="--bg: #f8f9fa"] .status-message.error,
        html[style*="--bg: #f8f9fa"] .status-message.error {
            background: rgba(220, 53, 69, 0.1);
            border-color: rgba(220, 53, 69, 0.25);
            color: #dc3545;
        }
        
        /* Light mode: Info section */
        :root[style*="--bg: #f8f9fa"] .info-section,
        html[style*="--bg: #f8f9fa"] .info-section {
            background: rgba(0, 102, 204, 0.05);
            border-color: rgba(0, 102, 204, 0.2);
            color: var(--text);
        }
        
        :root[style*="--bg: #f8f9fa"] .info-section h3,
        html[style*="--bg: #f8f9fa"] .info-section h3 {
            color: var(--text);
        }
        
        :root[style*="--bg: #f8f9fa"] .info-section p,
        :root[style*="--bg: #f8f9fa"] .info-section li,
        html[style*="--bg: #f8f9fa"] .info-section p,
        html[style*="--bg: #f8f9fa"] .info-section li {
            color: var(--muted);
        }
        
        :root[style*="--bg: #f8f9fa"] .info-section li::before,
        html[style*="--bg: #f8f9fa"] .info-section li::before {
            color: #0066cc;
        }
        
        /* Light mode: Reset section */
        :root[style*="--bg: #f8f9fa"] .reset-section,
        html[style*="--bg: #f8f9fa"] .reset-section {
            background: linear-gradient(135deg, #fff5e1 0%, #ffe8cc 100%);
            border-left-color: #ffc107;
            color: #1a1f36;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.15);
        }
        
        :root[style*="--bg: #f8f9fa"] .reset-section h3,
        html[style*="--bg: #f8f9fa"] .reset-section h3 {
            color: #ff9800;
        }
        
        :root[style*="--bg: #f8f9fa"] .reset-section p,
        html[style*="--bg: #f8f9fa"] .reset-section p {
            color: #b8860b;
        }
        
        /* Light mode: Buttons */
        :root[style*="--bg: #f8f9fa"] .reset-btn,
        html[style*="--bg: #f8f9fa"] .reset-btn {
            background: #ffc107;
            color: #1a1f36;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.2);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .reset-btn:hover,
        html[style*="--bg: #f8f9fa"] .reset-btn:hover {
            background: #ffb300;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
            transform: translateY(-2px);
        }
        
        :root[style*="--bg: #f8f9fa"] .refresh-btn,
        html[style*="--bg: #f8f9fa"] .refresh-btn {
            background: #0066cc;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.2);
            transition: all 0.2s ease;
        }
        
        :root[style*="--bg: #f8f9fa"] .refresh-btn:hover,
        html[style*="--bg: #f8f9fa"] .refresh-btn:hover {
            background: #0052a3;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
            transform: translateY(-2px);
        }

        .simulator-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header Section */
        .simulator-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px 40px;
            border-radius: 16px;
            color: white;
            margin-bottom: 40px;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
            text-align: center;
        }

        .simulator-header h1 {
            margin: 0 0 15px 0;
            font-size: 2.8em;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .simulator-header p {
            margin: 0;
            opacity: 0.95;
            font-size: 1.15em;
            font-weight: 300;
        }

        /* Status Section */
        .status-section {
            margin-bottom: 45px;
        }

        .section-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title h2 {
            margin: 0;
            font-size: 1.6em;
            color: #e0e0e0;
            font-weight: 600;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        /* Status Display Grid */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            background: linear-gradient(135deg, #1e1e3f 0%, #2a2a5a 100%);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .status-card:hover {
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.2);
            transform: translateY(-3px);
        }

        .status-label {
            color: #a0a0c0;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .status-value {
            color: #667eea;
            font-size: 2.2em;
            font-weight: 700;
            margin: 0;
            line-height: 1;
        }

        .status-unit {
            color: #a0a0c0;
            font-size: 0.5em;
            margin-left: 5px;
        }

        /* Scenarios Section */
        .scenarios-section {
            margin-bottom: 40px;
        }

        .scenarios-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .scenario-card {
            background: linear-gradient(135deg, #1e1e3f 0%, #2a2a5a 100%);
            padding: 28px;
            border-radius: 12px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .scenario-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .scenario-card:hover {
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.25);
            transform: translateY(-5px);
        }

        .scenario-card:hover::before {
            opacity: 1;
        }

        .scenario-icon {
            font-size: 2.5em;
            margin-bottom: 12px;
        }

        .scenario-card h4 {
            margin: 0 0 12px 0;
            color: #e0e0e0;
            font-size: 1.25em;
            font-weight: 600;
        }

        .scenario-card p {
            margin: 0 0 20px 0;
            color: #b0b0d0;
            font-size: 0.95em;
            line-height: 1.5;
            flex-grow: 1;
        }

        .scenario-input {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            padding: 10px 14px;
            border-radius: 6px;
            color: #e0e0e0;
            margin-bottom: 12px;
            font-size: 0.95em;
            transition: all 0.2s ease;
        }

        .scenario-input:focus {
            outline: none;
            border-color: rgba(102, 126, 234, 0.8);
            background: rgba(102, 126, 234, 0.05);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .scenario-input::placeholder {
            color: #808099;
        }

        .scenario-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 11px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            width: 100%;
        }

        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .scenario-btn:active {
            transform: translateY(0);
        }

        .scenario-btn.danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.3);
        }

        .scenario-btn.danger:hover {
            box-shadow: 0 6px 16px rgba(245, 87, 108, 0.4);
        }

        /* Info Section */
        .info-section {
            background: linear-gradient(135deg, #1e1e3f 0%, #2a2a5a 100%);
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .info-section h3 {
            margin-top: 0;
            margin-bottom: 18px;
            color: #667eea;
            font-size: 1.3em;
            font-weight: 600;
        }

        .info-section ul {
            margin: 0;
            padding-left: 20px;
            color: #b0b0d0;
            list-style: none;
        }

        .info-section li {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .info-section li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: 700;
        }

        /* Reset Section */
        .reset-section {
            background: linear-gradient(135deg, #1e1e3f 0%, #2a2a5a 100%);
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #ffc107;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .reset-section h3 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #ffc107;
            font-size: 1.3em;
            font-weight: 600;
        }

        .reset-section p {
            color: #b0b0d0;
            margin-bottom: 20px;
            font-size: 0.95em;
        }

        .reset-btn {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: #1e1e3f;
            border: none;
            padding: 14px 40px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1em;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 193, 7, 0.4);
        }

        .reset-btn:active {
            transform: translateY(0);
        }

        /* Status Messages */
        .status-message {
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            display: none;
            font-weight: 500;
            border-left: 4px solid;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status-message.success {
            background: rgba(76, 175, 80, 0.1);
            color: #81c784;
            border-left-color: #4caf50;
            display: block;
        }

        .status-message.error {
            background: rgba(244, 67, 54, 0.1);
            color: #ef5350;
            border-left-color: #f44336;
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .simulator-header {
                padding: 35px 25px;
                margin-bottom: 30px;
            }

            .simulator-header h1 {
                font-size: 2em;
            }

            .scenarios-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .status-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .section-title {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .refresh-btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .status-grid {
                grid-template-columns: 1fr;
            }

            .simulator-container {
                padding: 15px 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="nav-logo">
                üåô Morpheus
            </a>
            <ul class="nav-menu">
                <li><a href="/live">üìä En Direct</a></li>
                <li><a href="/dashboard">üìà Tableau de Bord</a></li>
                <li><a href="/report">üìã Rapports</a></li>
                <li><a href="/settings">‚öôÔ∏è Param√®tres</a></li>
                {% if is_admin %}
                <li><a href="/admin" class="nav-admin">üîê Admin</a></li>
                {% endif %}
                <li><a href="/logout">üö™ D√©connexion</a></li>
            </ul>
        </div>
    </nav>

    <div class="simulator-container">
        <!-- Header -->
        <div class="simulator-header">
            <h1>üî¨ Simulateur Capteur CO‚ÇÇ</h1>
            <p>Testez diff√©rents sc√©narios pour valider le syst√®me de monitoring</p>
        </div>

        <!-- Status Message -->
        <div id="statusMessage" class="status-message"></div>

        <!-- Status Section -->
        <div class="status-section">
            <div class="section-title">
                <h2>√âtat Actuel</h2>
                <button class="refresh-btn" onclick="loadSimulatorStatus()">üîÑ Actualiser</button>
            </div>

            <div class="status-grid">
                <div class="status-card">
                    <div class="status-label">Sc√©nario Actuel</div>
                    <div class="status-value" id="sim-scenario">NORMAL</div>
                </div>
                <div class="status-card">
                    <div class="status-label">CO‚ÇÇ (PPM)</div>
                    <div class="status-value" id="sim-co2">600<span class="status-unit">ppm</span></div>
                </div>
                <div class="status-card">
                    <div class="status-label">Temp√©rature</div>
                    <div class="status-value" id="sim-temp">22.0<span class="status-unit">¬∞C</span></div>
                </div>
                <div class="status-card">
                    <div class="status-label">Humidit√©</div>
                    <div class="status-value" id="sim-humidity">45.0<span class="status-unit">%</span></div>
                </div>
            </div>
        </div>

        <!-- Scenarios Section -->
        <div class="scenarios-section">
            <h2 style="margin-bottom: 30px; font-size: 1.6em; color: #e0e0e0; font-weight: 600;">S√©lectionner un Sc√©nario</h2>
            <div class="scenarios-grid">
                <div class="scenario-card">
                    <div class="scenario-icon">üè¢</div>
                    <h4>Normal</h4>
                    <p>Fonctionnement normal avec variations mineures. CO‚ÇÇ stable autour de 600 ppm avec oscillations naturelles.</p>
                    <input type="number" id="normal-duration" class="scenario-input" value="0" placeholder="Dur√©e (min, 0=infini)" min="0" max="1440">
                    <button class="scenario-btn" onclick="setSimulatorScenario('normal')">Activer</button>
                </div>

                <div class="scenario-card">
                    <div class="scenario-icon">üë•</div>
                    <h4>Heures de Bureau</h4>
                    <p>Personnes pr√©sentes, CO‚ÇÇ monte progressivement. Simule une augmentation graduelle due √† l'occupation.</p>
                    <input type="number" id="office_hours-duration" class="scenario-input" value="0" placeholder="Dur√©e (min, 0=infini)" min="0" max="1440">
                    <button class="scenario-btn" onclick="setSimulatorScenario('office_hours')">Activer</button>
                </div>

                <div class="scenario-card">
                    <div class="scenario-icon">üåô</div>
                    <h4>Sommeil</h4>
                    <p>Peu ou pas de personnes pr√©sentes, CO‚ÇÇ tr√®s stable et bas. Conditions minimales d'occupation.</p>
                    <input type="number" id="sleep-duration" class="scenario-input" value="0" placeholder="Dur√©e (min, 0=infini)" min="0" max="1440">
                    <button class="scenario-btn" onclick="setSimulatorScenario('sleep')">Activer</button>
                </div>

                <div class="scenario-card">
                    <div class="scenario-icon">üí®</div>
                    <h4>Ventilation Active</h4>
                    <p>Syst√®me de ventilation en cours de fonctionnement. CO‚ÇÇ baisse rapidement. Simule un renouvellement d'air efficace.</p>
                    <input type="number" id="ventilation_active-duration" class="scenario-input" value="0" placeholder="Dur√©e (min, 0=infini)" min="0" max="1440">
                    <button class="scenario-btn" onclick="setSimulatorScenario('ventilation_active')">Activer</button>
                </div>

                <div class="scenario-card">
                    <div class="scenario-icon">‚ö†Ô∏è</div>
                    <h4>Anomalie Capteur</h4>
                    <p>Simuler une anomalie de capteur. Pics al√©atoires, d√©rive progressive ou interruptions de donn√©es.</p>
                    <input type="number" id="anomaly-duration" class="scenario-input" value="0" placeholder="Dur√©e (min, 0=infini)" min="0" max="1440">
                    <button class="scenario-btn danger" onclick="setSimulatorScenario('anomaly')">Activer</button>
                </div>
            </div>
        </div>

        <!-- Info Box -->
        <div class="info-section">
            <h3>‚ÑπÔ∏è Comment Utiliser le Simulateur</h3>
            <ul>
                <li><strong>Sc√©narios:</strong> Choisissez un sc√©nario pour simuler diff√©rentes conditions d'occupation</li>
                <li><strong>Dur√©e:</strong> D√©finissez la dur√©e en minutes (0 = infini jusqu'au changement manuel)</li>
                <li><strong>Donn√©es en temps r√©el:</strong> Les donn√©es simul√©es sont transmises via WebSocket</li>
                <li><strong>Persistance:</strong> Toutes les mesures sont enregistr√©es dans la base de donn√©es</li>
                <li><strong>Int√©gration:</strong> Visualisez les donn√©es sur la page "En Direct" ou au "Tableau de Bord"</li>
                <li><strong>Variables r√©alistes:</strong> Chaque sc√©nario g√©n√®re CO‚ÇÇ, temp√©rature et humidit√© coh√©rents</li>
            </ul>
        </div>

        <!-- Reset Section -->
        <div class="reset-section">
            <h3>üîÑ R√©initialiser le Simulateur</h3>
            <p>Revenir √† l'√©tat initial avec une valeur CO‚ÇÇ personnalis√©e</p>
            <button class="reset-btn" onclick="resetSimulator()">R√©initialiser</button>
        </div>
    </div>

    <script>
        // Auto-load status on page load
        window.addEventListener('load', () => {
            loadSimulatorStatus();
            // Auto-refresh every 2 seconds
            setInterval(loadSimulatorStatus, 2000);
        });

        function showMessage(message, type = 'success') {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status-message ' + type;
            setTimeout(() => {
                statusDiv.className = 'status-message';
            }, 4000);
        }

        async function loadSimulatorStatus() {
            try {
                const response = await fetch('/api/simulator/status');
                const data = await response.json();
                
                if (data.success) {
                    const sim = data.simulator;
                    document.getElementById('sim-scenario').textContent = sim.scenario.toUpperCase();
                    document.getElementById('sim-co2').innerHTML = Math.round(sim.co2) + '<span class="status-unit">ppm</span>';
                    document.getElementById('sim-temp').innerHTML = sim.temperature.toFixed(1) + '<span class="status-unit">¬∞C</span>';
                    document.getElementById('sim-humidity').innerHTML = sim.humidity.toFixed(1) + '<span class="status-unit">%</span>';
                }
            } catch (error) {
                console.error('Error loading simulator status:', error);
            }
        }

        async function setSimulatorScenario(scenario) {
            const durationInput = document.getElementById(scenario + '-duration');
            const duration = parseInt(durationInput?.value || 0);

            try {
                const response = await fetch(`/api/simulator/scenario/${scenario}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({duration: duration * 60})
                });
                const data = await response.json();
                
                if (data.success) {
                    showMessage(`‚úì Sc√©nario activ√©: ${scenario}`, 'success');
                    setTimeout(loadSimulatorStatus, 300);
                } else {
                    showMessage('‚úó Erreur: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('Erreur: ' + error, 'error');
            }
        }

        async function resetSimulator() {
            const baseCO2 = prompt('Valeur CO2 initiale (ppm):', '600');
            if (baseCO2 && !isNaN(baseCO2)) {
                try {
                    const response = await fetch('/api/simulator/reset', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            base_co2: parseInt(baseCO2),
                            scenario: 'normal'
                        })
                    });
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage('‚úì Simulateur r√©initialis√©', 'success');
                        setTimeout(loadSimulatorStatus, 300);
                    } else {
                        showMessage('‚úó Erreur: ' + data.error, 'error');
                    }
                } catch (error) {
                    showMessage('Erreur: ' + error, 'error');
                }
            }
        }
    </script>
</body>
</html>
